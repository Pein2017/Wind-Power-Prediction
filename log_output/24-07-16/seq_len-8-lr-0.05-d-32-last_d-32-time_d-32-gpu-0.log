Running experiment with config: Namespace(seed=17, is_training=1, task_name='default', des='test', comment='grid search', log_output_dir='/data3/lsf/Pein/Power-Prediction/log_output/24-07-16', output_dir='/data3/lsf/Pein/Power-Prediction/output/24-07-16', final_best_metrics_log_path='/data3/lsf/Pein/Power-Prediction/final_best_metrics.log', data_root_dir='/data3/lsf/Pein/Power-Prediction/data', train_path='train_data_89_withTime.csv', test_path='train_data_89_withTime.csv', train_val_split=0.2, target='power', inverse=True, num_workers=8, data='WindPower', model='SimpleMLP', input_dim=75, dec_in=75, output_dim=1, d_model=32, n_heads=4, e_layers=6, d_layers=1, hidden_dim=64, last_hidden_dim=32, top_k=5, num_kernels=6, activation='gelu', time_d_model=32, combine_type='add', seq_len=8, pred_len=1, exp_settings='seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100', gradient_clip_val=2, train_epochs=100, batch_size=1100, early_stop_patience=6, learning_rate=0.05, loss='MSE', lradj='TST', pct_start=0.2, use_amp=False, moving_avg=25, dropout=0.1, decomp_method='moving_avg', use_norm=1, down_sampling_layers=2, down_sampling_window=2, down_sampling_method='avg', scheduler_type='OneCycleLR', T_max=20, weight_decay=0.0001, patience=5, Reduce_factor=0.2, use_gpu=True, gpu=0, use_multi_gpu=False, use_all_gpus_for_search=True, min_y_value=0.0)


min_y_value has been set to 0.0

/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python /data3/lsf/Pein/Power-Prediction/run_scripts/run_exp ...
/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py:298: The number of training batches (11) is smaller than the logging interval Trainer(log_every_n_steps=1100). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
Epoch 1:
val loss improved to 0.17088
test loss improved to 0.27332
train loss: inf | val loss: 0.17088 | test loss: 0.27332

Experiment Settings: seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | inf           | inf           | inf           | -1    |
| Val RMSE                     | 713.4189      | 679.4446      | 707.0059      | 1     |
| Test RMSE                    | 713.4189      | 679.4446      | 707.0059      | 1     |
| Best Train Custom Accuracy   | inf           |               |               | -1    |
| Best Val Custom Accuracy     |               | 11.3060       |               | 1     |
| Best Test Custom Accuracy    |               |               | 6.7409        | 1     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 2:
train loss improved to 0.30512
test loss improved to 0.21891
train loss: 0.30512 | val loss: 0.17088 | test loss: 0.21891

Experiment Settings: seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 481.8822      | 629.7665      | 515.2789      | 2     |
| Val RMSE                     | 713.4189      | 679.4446      | 707.0059      | 1     |
| Test RMSE                    | 481.8822      | 629.7665      | 515.2789      | 2     |
| Best Train Custom Accuracy   | 1.2664        |               |               | 2     |
| Best Val Custom Accuracy     |               | 11.3060       |               | 1     |
| Best Test Custom Accuracy    |               |               | 9.8543        | 2     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 3:
train loss improved to 0.08910
test loss improved to 0.19083
train loss: 0.08910 | val loss: 0.17088 | test loss: 0.19083

Experiment Settings: seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 513.1796      | 453.7253      | 502.1405      | 3     |
| Val RMSE                     | 713.4189      | 679.4446      | 707.0059      | 1     |
| Test RMSE                    | 513.1796      | 453.7253      | 502.1405      | 3     |
| Best Train Custom Accuracy   | -100.9536     |               |               | 3     |
| Best Val Custom Accuracy     |               | 11.3060       |               | 1     |
| Best Test Custom Accuracy    |               |               | -67.9898      | 3     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 4:
train loss improved to 0.03693
val loss improved to 0.06484
test loss improved to 0.07805
train loss: 0.03693 | val loss: 0.06484 | test loss: 0.07805

Experiment Settings: seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 397.3358      | 492.0467      | 418.0485      | 4     |
| Val RMSE                     | 397.3358      | 492.0467      | 418.0485      | 4     |
| Test RMSE                    | 397.3358      | 492.0467      | 418.0485      | 4     |
| Best Train Custom Accuracy   | -219.3974     |               |               | 4     |
| Best Val Custom Accuracy     |               | -426.0570     |               | 4     |
| Best Test Custom Accuracy    |               |               | -179.6371     | 4     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 5:
train loss improved to 0.02552
test loss improved to 0.05284
train loss: 0.02552 | val loss: 0.06484 | test loss: 0.05284

Experiment Settings: seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 319.4587      | 437.4116      | 346.6363      | 5     |
| Val RMSE                     | 397.3358      | 492.0467      | 418.0485      | 4     |
| Test RMSE                    | 319.4587      | 437.4116      | 346.6363      | 5     |
| Best Train Custom Accuracy   | -131.0171     |               |               | 5     |
| Best Val Custom Accuracy     |               | -426.0570     |               | 4     |
| Best Test Custom Accuracy    |               |               | -108.6253     | 5     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 6:
train loss improved to 0.02368
val loss improved to 0.05813
test loss improved to 0.04086
train loss: 0.02368 | val loss: 0.05813 | test loss: 0.04086

Experiment Settings: seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 336.9842      | 424.6417      | 356.7056      | 6     |
| Val RMSE                     | 336.9842      | 424.6417      | 356.7056      | 6     |
| Test RMSE                    | 336.9842      | 424.6417      | 356.7056      | 6     |
| Best Train Custom Accuracy   | -57.3629      |               |               | 6     |
| Best Val Custom Accuracy     |               | -136.5833     |               | 6     |
| Best Test Custom Accuracy    |               |               | -43.8521      | 6     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 7:
train loss improved to 0.02048
val loss improved to 0.05632
train loss: 0.02048 | val loss: 0.05632 | test loss: 0.04086

Experiment Settings: seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 292.8444      | 423.7746      | 323.8239      | 7     |
| Val RMSE                     | 292.8444      | 423.7746      | 323.8239      | 7     |
| Test RMSE                    | 336.9842      | 424.6417      | 356.7056      | 6     |
| Best Train Custom Accuracy   | -50.0623      |               |               | 7     |
| Best Val Custom Accuracy     |               | -144.0648     |               | 7     |
| Best Test Custom Accuracy    |               |               | -43.8521      | 6     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 8:
train loss improved to 0.01823
test loss improved to 0.03998
train loss: 0.01823 | val loss: 0.05632 | test loss: 0.03998

Experiment Settings: seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 243.3128      | 418.5053      | 287.6721      | 8     |
| Val RMSE                     | 292.8444      | 423.7746      | 323.8239      | 7     |
| Test RMSE                    | 243.3128      | 418.5053      | 287.6721      | 8     |
| Best Train Custom Accuracy   | -54.8971      |               |               | 8     |
| Best Val Custom Accuracy     |               | -144.0648     |               | 7     |
| Best Test Custom Accuracy    |               |               | -39.0571      | 8     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 9:
train loss improved to 0.01616
val loss improved to 0.05485
test loss improved to 0.03417
train loss: 0.01616 | val loss: 0.05485 | test loss: 0.03417

Experiment Settings: seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 219.9995      | 430.6861      | 275.8687      | 9     |
| Val RMSE                     | 219.9995      | 430.6861      | 275.8687      | 9     |
| Test RMSE                    | 219.9995      | 430.6861      | 275.8687      | 9     |
| Best Train Custom Accuracy   | -38.0076      |               |               | 9     |
| Best Val Custom Accuracy     |               | -152.7141     |               | 9     |
| Best Test Custom Accuracy    |               |               | -29.1123      | 9     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 10:
train loss improved to 0.01511
test loss improved to 0.03181
train loss: 0.01511 | val loss: 0.05485 | test loss: 0.03181

Experiment Settings: seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 230.5615      | 456.5726      | 290.8113      | 10    |
| Val RMSE                     | 219.9995      | 430.6861      | 275.8687      | 9     |
| Test RMSE                    | 230.5615      | 456.5726      | 290.8113      | 10    |
| Best Train Custom Accuracy   | -2.4149       |               |               | 10    |
| Best Val Custom Accuracy     |               | -152.7141     |               | 9     |
| Best Test Custom Accuracy    |               |               | -6.3143       | 10    |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 12:
train loss improved to 0.01488
train loss: 0.01488 | val loss: 0.05485 | test loss: 0.03181

Experiment Settings: seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 256.8468      | 440.1727      | 302.8826      | 12    |
| Val RMSE                     | 219.9995      | 430.6861      | 275.8687      | 9     |
| Test RMSE                    | 230.5615      | 456.5726      | 290.8113      | 10    |
| Best Train Custom Accuracy   | -16.7252      |               |               | 12    |
| Best Val Custom Accuracy     |               | -152.7141     |               | 9     |
| Best Test Custom Accuracy    |               |               | -6.3143       | 10    |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 13:
train loss improved to 0.01411
train loss: 0.01411 | val loss: 0.05485 | test loss: 0.03181

Experiment Settings: seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 189.3658      | 468.2906      | 270.0353      | 13    |
| Val RMSE                     | 219.9995      | 430.6861      | 275.8687      | 9     |
| Test RMSE                    | 230.5615      | 456.5726      | 290.8113      | 10    |
| Best Train Custom Accuracy   | 12.6352       |               |               | 13    |
| Best Val Custom Accuracy     |               | -152.7141     |               | 9     |
| Best Test Custom Accuracy    |               |               | -6.3143       | 10    |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 14:
train loss improved to 0.01198
train loss: 0.01198 | val loss: 0.05485 | test loss: 0.03181

Experiment Settings: seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 191.2579      | 457.6791      | 267.2655      | 14    |
| Val RMSE                     | 219.9995      | 430.6861      | 275.8687      | 9     |
| Test RMSE                    | 230.5615      | 456.5726      | 290.8113      | 10    |
| Best Train Custom Accuracy   | -5.7956       |               |               | 14    |
| Best Val Custom Accuracy     |               | -152.7141     |               | 9     |
| Best Test Custom Accuracy    |               |               | -6.3143       | 10    |
+------------------------------+---------------+---------------+---------------+-------+

min_y_value has been set to 0.0

Figure saved to /data3/lsf/Pein/Power-Prediction/output/24-07-16/seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100/version_0/plots/scaled_transform_together.pdf
Figure saved to /data3/lsf/Pein/Power-Prediction/output/24-07-16/seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100/version_0/plots/scaled_transform_separate.pdf
Figure saved to /data3/lsf/Pein/Power-Prediction/output/24-07-16/seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100/version_0/plots/original_transform_together.pdf
Figure saved to /data3/lsf/Pein/Power-Prediction/output/24-07-16/seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100/version_0/plots/original_transform_separate.pdf
best metrics saved to /data3/lsf/Pein/Power-Prediction/output/24-07-16/seq_len-8-lr-0.05-d-32-hid_d-64-last_d-32-time_d-32-e_layers-6-comb_type-add-bs-1100/version_0/metrics.csv successfully.
Experiment finished.
