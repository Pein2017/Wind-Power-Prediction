Running experiment with config: Namespace(seed=17, is_training=1, task_name='default', des='test', comment='debug', log_output_dir='/data3/lsf/Pein/Power-Prediction/log_output/debug', output_dir='/data3/lsf/Pein/Power-Prediction/output/debug', final_best_metrics_log_path='/data3/lsf/Pein/Power-Prediction/final_best_metrics.log', data_root_dir='/data3/lsf/Pein/Power-Prediction/data', train_path='train_data_89_withTime.csv', test_path='train_data_89_withTime.csv', train_val_split=0.2, target='power', inverse=True, num_workers=8, data='WindPower', model='SimpleMLP', input_dim=75, dec_in=75, output_dim=1, d_model=32, n_heads=4, e_layers=2, d_layers=1, hidden_dim=64, last_hidden_dim=32, top_k=5, num_kernels=6, activation='gelu', time_d_model=32, combine_type='add', seq_len=8, pred_len=1, exp_settings='seq_len-8-lr-0.15-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100', gradient_clip_val=2, train_epochs=100, batch_size=1100, early_stop_patience=15, learning_rate=0.15, loss='MSE', lradj='TST', pct_start=0.2, use_amp=False, moving_avg=25, dropout=0.1, decomp_method='moving_avg', use_norm=1, down_sampling_layers=2, down_sampling_window=2, down_sampling_method='avg', scheduler_type='OneCycleLR', T_max=20, weight_decay=0.0001, patience=5, Reduce_factor=0.2, use_gpu=True, gpu=0, use_multi_gpu=False, use_all_gpus_for_search=True, min_y_value=0.0)


min_y_value has been set to 0.0

/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python /data3/lsf/Pein/Power-Prediction/run_scripts/run_exp ...
/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py:298: The number of training batches (11) is smaller than the logging interval Trainer(log_every_n_steps=1100). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
Epoch 1:
val loss improved to 0.33148
test loss improved to 0.78171
train loss: inf | val loss: 0.33148 | test loss: 0.78171

Experiment Settings: seq_len-8-lr-0.15-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | inf           | inf           | inf           | -1    |
| Val RMSE                     | 583.7867      | 640.7658      | 595.9551      | 1     |
| Test RMSE                    | 583.7867      | 640.7658      | 595.9551      | 1     |
| Best Train Custom Accuracy   | inf           |               |               | -1    |
| Best Val Custom Accuracy     |               | 15.1833       |               | 1     |
| Best Test Custom Accuracy    |               |               | 15.1319       | 1     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 2:
train loss improved to 0.20296
val loss improved to 0.23580
test loss improved to 0.19386
train loss: 0.20296 | val loss: 0.23580 | test loss: 0.19386

Experiment Settings: seq_len-8-lr-0.15-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 384.0659      | 461.8474      | 401.4653      | 2     |
| Val RMSE                     | 384.0659      | 461.8474      | 401.4653      | 2     |
| Test RMSE                    | 384.0659      | 461.8474      | 401.4653      | 2     |
| Best Train Custom Accuracy   | -31.9965      |               |               | 2     |
| Best Val Custom Accuracy     |               | 3.3887        |               | 2     |
| Best Test Custom Accuracy    |               |               | -2.9161       | 2     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 3:
train loss improved to 0.05367
val loss improved to 0.09227
test loss improved to 0.06965
train loss: 0.05367 | val loss: 0.09227 | test loss: 0.06965

Experiment Settings: seq_len-8-lr-0.15-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 422.7103      | 464.6819      | 431.8414      | 3     |
| Val RMSE                     | 422.7103      | 464.6819      | 431.8414      | 3     |
| Test RMSE                    | 422.7103      | 464.6819      | 431.8414      | 3     |
| Best Train Custom Accuracy   | -190.2589     |               |               | 3     |
| Best Val Custom Accuracy     |               | -249.9890     |               | 3     |
| Best Test Custom Accuracy    |               |               | -133.1589     | 3     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 4:
train loss improved to 0.02854
val loss improved to 0.06587
test loss improved to 0.05769
train loss: 0.02854 | val loss: 0.06587 | test loss: 0.05769

Experiment Settings: seq_len-8-lr-0.15-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 345.8246      | 425.4004      | 363.8604      | 4     |
| Val RMSE                     | 345.8246      | 425.4004      | 363.8604      | 4     |
| Test RMSE                    | 345.8246      | 425.4004      | 363.8604      | 4     |
| Best Train Custom Accuracy   | -16.0856      |               |               | 4     |
| Best Val Custom Accuracy     |               | -32.8620      |               | 4     |
| Best Test Custom Accuracy    |               |               | -4.2005       | 4     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 5:
train loss improved to 0.02241
val loss improved to 0.06411
test loss improved to 0.05287
train loss: 0.02241 | val loss: 0.06411 | test loss: 0.05287

Experiment Settings: seq_len-8-lr-0.15-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 377.2066      | 423.3376      | 387.3979      | 5     |
| Val RMSE                     | 377.2066      | 423.3376      | 387.3979      | 5     |
| Test RMSE                    | 377.2066      | 423.3376      | 387.3979      | 5     |
| Best Train Custom Accuracy   | -43.9094      |               |               | 5     |
| Best Val Custom Accuracy     |               | -80.4317      |               | 5     |
| Best Test Custom Accuracy    |               |               | -27.4376      | 5     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 6:
train loss improved to 0.02008
val loss improved to 0.05732
train loss: 0.02008 | val loss: 0.05732 | test loss: 0.05287

Experiment Settings: seq_len-8-lr-0.15-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 310.4716      | 419.1872      | 335.7824      | 6     |
| Val RMSE                     | 310.4716      | 419.1872      | 335.7824      | 6     |
| Test RMSE                    | 377.2066      | 423.3376      | 387.3979      | 5     |
| Best Train Custom Accuracy   | -27.1852      |               |               | 6     |
| Best Val Custom Accuracy     |               | -31.0764      |               | 6     |
| Best Test Custom Accuracy    |               |               | -27.4376      | 5     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 7:
train loss improved to 0.01845
val loss improved to 0.05632
test loss improved to 0.04400
train loss: 0.01845 | val loss: 0.05632 | test loss: 0.04400

Experiment Settings: seq_len-8-lr-0.15-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 270.0238      | 406.8199      | 303.0016      | 7     |
| Val RMSE                     | 270.0238      | 406.8199      | 303.0016      | 7     |
| Test RMSE                    | 270.0238      | 406.8199      | 303.0016      | 7     |
| Best Train Custom Accuracy   | -47.9281      |               |               | 7     |
| Best Val Custom Accuracy     |               | -85.4413      |               | 7     |
| Best Test Custom Accuracy    |               |               | -27.0356      | 7     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 8:
train loss improved to 0.01727
val loss improved to 0.05214
test loss improved to 0.03660
train loss: 0.01727 | val loss: 0.05214 | test loss: 0.03660

Experiment Settings: seq_len-8-lr-0.15-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 241.6036      | 408.3591      | 283.7174      | 8     |
| Val RMSE                     | 241.6036      | 408.3591      | 283.7174      | 8     |
| Test RMSE                    | 241.6036      | 408.3591      | 283.7174      | 8     |
| Best Train Custom Accuracy   | -23.9825      |               |               | 8     |
| Best Val Custom Accuracy     |               | -90.2033      |               | 8     |
| Best Test Custom Accuracy    |               |               | -13.9055      | 8     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 9:
train loss improved to 0.01667
test loss improved to 0.03346
train loss: 0.01667 | val loss: 0.05214 | test loss: 0.03346

Experiment Settings: seq_len-8-lr-0.15-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 228.8905      | 404.1475      | 273.6573      | 9     |
| Val RMSE                     | 241.6036      | 408.3591      | 283.7174      | 8     |
| Test RMSE                    | 228.8905      | 404.1475      | 273.6573      | 9     |
| Best Train Custom Accuracy   | -66.5810      |               |               | 9     |
| Best Val Custom Accuracy     |               | -90.2033      |               | 8     |
| Best Test Custom Accuracy    |               |               | -44.4468      | 9     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 10:
train loss improved to 0.01633
val loss improved to 0.05083
test loss improved to 0.03049
train loss: 0.01633 | val loss: 0.05083 | test loss: 0.03049

Experiment Settings: seq_len-8-lr-0.15-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 229.5818      | 409.3969      | 275.7834      | 10    |
| Val RMSE                     | 229.5818      | 409.3969      | 275.7834      | 10    |
| Test RMSE                    | 229.5818      | 409.3969      | 275.7834      | 10    |
| Best Train Custom Accuracy   | -42.2557      |               |               | 10    |
| Best Val Custom Accuracy     |               | -122.2929     |               | 10    |
| Best Test Custom Accuracy    |               |               | -26.1306      | 10    |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 11:
train loss improved to 0.01402
train loss: 0.01402 | val loss: 0.05083 | test loss: 0.03049

Experiment Settings: seq_len-8-lr-0.15-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 283.7437      | 471.1782      | 330.6437      | 11    |
| Val RMSE                     | 229.5818      | 409.3969      | 275.7834      | 10    |
| Test RMSE                    | 229.5818      | 409.3969      | 275.7834      | 10    |
| Best Train Custom Accuracy   | -20.6011      |               |               | 11    |
| Best Val Custom Accuracy     |               | -122.2929     |               | 10    |
| Best Test Custom Accuracy    |               |               | -26.1306      | 10    |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 17:
train loss improved to 0.01353
test loss improved to 0.02949
train loss: 0.01353 | val loss: 0.05083 | test loss: 0.02949

Experiment Settings: seq_len-8-lr-0.15-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 3570.3274     | 1873.6924     | 3301.0330     | 17    |
| Val RMSE                     | 229.5818      | 409.3969      | 275.7834      | 10    |
| Test RMSE                    | 3570.3274     | 1873.6924     | 3301.0330     | 17    |
| Best Train Custom Accuracy   | -434.8672     |               |               | 17    |
| Best Val Custom Accuracy     |               | -122.2929     |               | 10    |
| Best Test Custom Accuracy    |               |               | -333.1248     | 17    |
+------------------------------+---------------+---------------+---------------+-------+
Error during experiment: WindPowerExperiment.__init__() missing 1 required positional argument: 'config'
Traceback (most recent call last):
  File "/data3/lsf/Pein/Power-Prediction/run_scripts/run_exp.py", line 50, in execute_experiment_with_logging
    execute_experiment(config)
  File "/data3/lsf/Pein/Power-Prediction/run_scripts/single_exp.py", line 106, in execute_experiment
    custom_test(
  File "/data3/lsf/Pein/Power-Prediction/utils/results.py", line 103, in custom_test
    pl_module = model_class.load_from_checkpoint(best_model_path)
  File "/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/pytorch_lightning/utilities/model_helpers.py", line 125, in wrapper
    return self.method(cls, *args, **kwargs)
  File "/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1586, in load_from_checkpoint
    loaded = _load_from_checkpoint(
  File "/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/pytorch_lightning/core/saving.py", line 91, in _load_from_checkpoint
    model = _load_state(cls, checkpoint, strict=strict, **kwargs)
  File "/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/pytorch_lightning/core/saving.py", line 165, in _load_state
    obj = instantiator(cls, _cls_kwargs) if instantiator else cls(**_cls_kwargs)
TypeError: WindPowerExperiment.__init__() missing 1 required positional argument: 'config'
Experiment finished.
