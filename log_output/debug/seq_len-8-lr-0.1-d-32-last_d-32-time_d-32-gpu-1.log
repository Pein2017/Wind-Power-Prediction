Running experiment with config: Namespace(seed=17, is_training=1, task_name='default', des='test', comment='debug', log_output_dir='/data3/lsf/Pein/Power-Prediction/log_output/debug', output_dir='/data3/lsf/Pein/Power-Prediction/output/debug', final_best_metrics_log_path='/data3/lsf/Pein/Power-Prediction/final_best_metrics.log', data_root_dir='/data3/lsf/Pein/Power-Prediction/data', train_path='train_data_89_withTime.csv', test_path='train_data_89_withTime.csv', train_val_split=0.2, target='power', inverse=True, num_workers=8, data='WindPower', model='SimpleMLP', input_dim=75, dec_in=75, output_dim=1, d_model=32, n_heads=4, e_layers=2, d_layers=1, hidden_dim=64, last_hidden_dim=32, top_k=5, num_kernels=6, activation='gelu', time_d_model=32, combine_type='add', seq_len=8, pred_len=1, exp_settings='seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100', gradient_clip_val=2, train_epochs=100, batch_size=1100, early_stop_patience=15, learning_rate=0.1, loss='MSE', lradj='TST', pct_start=0.2, use_amp=False, moving_avg=25, dropout=0.1, decomp_method='moving_avg', use_norm=1, down_sampling_layers=2, down_sampling_window=2, down_sampling_method='avg', scheduler_type='OneCycleLR', T_max=20, weight_decay=0.0001, patience=5, Reduce_factor=0.2, use_gpu=True, gpu=1, use_multi_gpu=False, use_all_gpus_for_search=True, min_y_value=0.0)


min_y_value has been set to 0.0

/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python /data3/lsf/Pein/Power-Prediction/run_scripts/run_exp ...
/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py:298: The number of training batches (11) is smaller than the logging interval Trainer(log_every_n_steps=1100). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
Epoch 1:
val loss improved to 0.33148
test loss improved to 0.78171
train loss: inf | val loss: 0.33148 | test loss: 0.78171

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | inf           | inf           | inf           | -1    |
| Val RMSE                     | 619.3040      | 665.4756      | 629.1129      | 1     |
| Test RMSE                    | 619.3040      | 665.4756      | 629.1129      | 1     |
| Best Train Custom Accuracy   | inf           |               |               | -1    |
| Best Val Custom Accuracy     |               | 13.3196       |               | 1     |
| Best Test Custom Accuracy    |               |               | 13.2179       | 1     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 2:
train loss improved to 0.21455
val loss improved to 0.23178
test loss improved to 0.19489
train loss: 0.21455 | val loss: 0.23178 | test loss: 0.19489

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 421.9462      | 506.9835      | 440.8217      | 2     |
| Val RMSE                     | 421.9462      | 506.9835      | 440.8217      | 2     |
| Test RMSE                    | 421.9462      | 506.9835      | 440.8217      | 2     |
| Best Train Custom Accuracy   | 2.3343        |               |               | 2     |
| Best Val Custom Accuracy     |               | 21.0938       |               | 2     |
| Best Test Custom Accuracy    |               |               | 15.0375       | 2     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 3:
train loss improved to 0.07217
val loss improved to 0.12206
test loss improved to 0.09078
train loss: 0.07217 | val loss: 0.12206 | test loss: 0.09078

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 566.3611      | 665.8704      | 587.5128      | 3     |
| Val RMSE                     | 566.3611      | 665.8704      | 587.5128      | 3     |
| Test RMSE                    | 566.3611      | 665.8704      | 587.5128      | 3     |
| Best Train Custom Accuracy   | -417.4996     |               |               | 3     |
| Best Val Custom Accuracy     |               | -650.6325     |               | 3     |
| Best Test Custom Accuracy    |               |               | -332.3957     | 3     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 4:
train loss improved to 0.03124
train loss: 0.03124 | val loss: 0.12206 | test loss: 0.09078

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 318.5741      | 396.3425      | 336.3359      | 4     |
| Val RMSE                     | 566.3611      | 665.8704      | 587.5128      | 3     |
| Test RMSE                    | 566.3611      | 665.8704      | 587.5128      | 3     |
| Best Train Custom Accuracy   | -41.8873      |               |               | 4     |
| Best Val Custom Accuracy     |               | -650.6325     |               | 3     |
| Best Test Custom Accuracy    |               |               | -332.3957     | 3     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 5:
train loss improved to 0.02334
val loss improved to 0.05118
test loss improved to 0.04287
train loss: 0.02334 | val loss: 0.05118 | test loss: 0.04287

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 352.3314      | 410.5306      | 365.4174      | 5     |
| Val RMSE                     | 352.3314      | 410.5306      | 365.4174      | 5     |
| Test RMSE                    | 352.3314      | 410.5306      | 365.4174      | 5     |
| Best Train Custom Accuracy   | -43.4618      |               |               | 5     |
| Best Val Custom Accuracy     |               | -75.9600      |               | 5     |
| Best Test Custom Accuracy    |               |               | -24.5234      | 5     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 6:
train loss improved to 0.02039
train loss: 0.02039 | val loss: 0.05118 | test loss: 0.04287

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 250.6091      | 407.1598      | 289.3629      | 6     |
| Val RMSE                     | 352.3314      | 410.5306      | 365.4174      | 5     |
| Test RMSE                    | 352.3314      | 410.5306      | 365.4174      | 5     |
| Best Train Custom Accuracy   | -97.0848      |               |               | 6     |
| Best Val Custom Accuracy     |               | -75.9600      |               | 5     |
| Best Test Custom Accuracy    |               |               | -24.5234      | 5     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 7:
train loss improved to 0.01859
test loss improved to 0.03290
train loss: 0.01859 | val loss: 0.05118 | test loss: 0.03290

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 243.5570      | 406.3120      | 284.1960      | 7     |
| Val RMSE                     | 352.3314      | 410.5306      | 365.4174      | 5     |
| Test RMSE                    | 243.5570      | 406.3120      | 284.1960      | 7     |
| Best Train Custom Accuracy   | -118.2643     |               |               | 7     |
| Best Val Custom Accuracy     |               | -75.9600      |               | 5     |
| Best Test Custom Accuracy    |               |               | -84.3201      | 7     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 8:
train loss improved to 0.01743
val loss improved to 0.05092
test loss improved to 0.03141
train loss: 0.01743 | val loss: 0.05092 | test loss: 0.03141

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 228.1960      | 393.4489      | 270.0608      | 8     |
| Val RMSE                     | 228.1960      | 393.4489      | 270.0608      | 8     |
| Test RMSE                    | 228.1960      | 393.4489      | 270.0608      | 8     |
| Best Train Custom Accuracy   | -70.8951      |               |               | 8     |
| Best Val Custom Accuracy     |               | -150.9909     |               | 8     |
| Best Test Custom Accuracy    |               |               | -49.0483      | 8     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 9:
train loss improved to 0.01647
val loss improved to 0.04795
test loss improved to 0.02908
train loss: 0.01647 | val loss: 0.04795 | test loss: 0.02908

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 244.8369      | 410.5183      | 286.6487      | 9     |
| Val RMSE                     | 244.8369      | 410.5183      | 286.6487      | 9     |
| Test RMSE                    | 244.8369      | 410.5183      | 286.6487      | 9     |
| Best Train Custom Accuracy   | -20.1801      |               |               | 9     |
| Best Val Custom Accuracy     |               | -103.4056     |               | 9     |
| Best Test Custom Accuracy    |               |               | -15.6455      | 9     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 10:
train loss improved to 0.01512
train loss: 0.01512 | val loss: 0.04795 | test loss: 0.02908

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 246.1654      | 408.8234      | 286.8732      | 10    |
| Val RMSE                     | 244.8369      | 410.5183      | 286.6487      | 9     |
| Test RMSE                    | 244.8369      | 410.5183      | 286.6487      | 9     |
| Best Train Custom Accuracy   | -56.1519      |               |               | 10    |
| Best Val Custom Accuracy     |               | -103.4056     |               | 9     |
| Best Test Custom Accuracy    |               |               | -15.6455      | 9     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 11:
train loss improved to 0.01429
train loss: 0.01429 | val loss: 0.04795 | test loss: 0.02908

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 210.9352      | 416.0901      | 265.7953      | 11    |
| Val RMSE                     | 244.8369      | 410.5183      | 286.6487      | 9     |
| Test RMSE                    | 244.8369      | 410.5183      | 286.6487      | 9     |
| Best Train Custom Accuracy   | -47.7327      |               |               | 11    |
| Best Val Custom Accuracy     |               | -103.4056     |               | 9     |
| Best Test Custom Accuracy    |               |               | -15.6455      | 9     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 12:
train loss improved to 0.01390
train loss: 0.01390 | val loss: 0.04795 | test loss: 0.02908

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 200.1748      | 417.3377      | 259.3605      | 12    |
| Val RMSE                     | 244.8369      | 410.5183      | 286.6487      | 9     |
| Test RMSE                    | 244.8369      | 410.5183      | 286.6487      | 9     |
| Best Train Custom Accuracy   | -44.7422      |               |               | 12    |
| Best Val Custom Accuracy     |               | -103.4056     |               | 9     |
| Best Test Custom Accuracy    |               |               | -15.6455      | 9     |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 13:
train loss improved to 0.01212
test loss improved to 0.02871
train loss: 0.01212 | val loss: 0.04795 | test loss: 0.02871

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 310.2954      | 465.9975      | 347.8103      | 13    |
| Val RMSE                     | 244.8369      | 410.5183      | 286.6487      | 9     |
| Test RMSE                    | 310.2954      | 465.9975      | 347.8103      | 13    |
| Best Train Custom Accuracy   | -21.0404      |               |               | 13    |
| Best Val Custom Accuracy     |               | -103.4056     |               | 9     |
| Best Test Custom Accuracy    |               |               | -5.6193       | 13    |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 16:
test loss improved to 0.02522
train loss: 0.01212 | val loss: 0.04795 | test loss: 0.02522

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 310.2954      | 465.9975      | 347.8103      | 13    |
| Val RMSE                     | 244.8369      | 410.5183      | 286.6487      | 9     |
| Test RMSE                    | 179.7093      | 441.2176      | 254.9178      | 16    |
| Best Train Custom Accuracy   | -21.0404      |               |               | 13    |
| Best Val Custom Accuracy     |               | -103.4056     |               | 9     |
| Best Test Custom Accuracy    |               |               | -53.5752      | 16    |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 17:
train loss improved to 0.01142
train loss: 0.01142 | val loss: 0.04795 | test loss: 0.02522

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 236.9441      | 472.3757      | 300.0015      | 17    |
| Val RMSE                     | 244.8369      | 410.5183      | 286.6487      | 9     |
| Test RMSE                    | 179.7093      | 441.2176      | 254.9178      | 16    |
| Best Train Custom Accuracy   | 24.1542       |               |               | 17    |
| Best Val Custom Accuracy     |               | -103.4056     |               | 9     |
| Best Test Custom Accuracy    |               |               | -53.5752      | 16    |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 18:
train loss improved to 0.01039
train loss: 0.01039 | val loss: 0.04795 | test loss: 0.02522

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 183.9603      | 483.8518      | 272.4625      | 18    |
| Val RMSE                     | 244.8369      | 410.5183      | 286.6487      | 9     |
| Test RMSE                    | 179.7093      | 441.2176      | 254.9178      | 16    |
| Best Train Custom Accuracy   | 24.5793       |               |               | 18    |
| Best Val Custom Accuracy     |               | -103.4056     |               | 9     |
| Best Test Custom Accuracy    |               |               | -53.5752      | 16    |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 20:
train loss improved to 0.00873
test loss improved to 0.02445
train loss: 0.00873 | val loss: 0.04795 | test loss: 0.02445

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 161.5188      | 447.1282      | 247.3596      | 20    |
| Val RMSE                     | 244.8369      | 410.5183      | 286.6487      | 9     |
| Test RMSE                    | 161.5188      | 447.1282      | 247.3596      | 20    |
| Best Train Custom Accuracy   | -4.5510       |               |               | 20    |
| Best Val Custom Accuracy     |               | -103.4056     |               | 9     |
| Best Test Custom Accuracy    |               |               | -28.9478      | 20    |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 21:
train loss improved to 0.00748
train loss: 0.00748 | val loss: 0.04795 | test loss: 0.02445

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 158.3974      | 428.8813      | 239.2153      | 21    |
| Val RMSE                     | 244.8369      | 410.5183      | 286.6487      | 9     |
| Test RMSE                    | 161.5188      | 447.1282      | 247.3596      | 20    |
| Best Train Custom Accuracy   | 39.4072       |               |               | 21    |
| Best Val Custom Accuracy     |               | -103.4056     |               | 9     |
| Best Test Custom Accuracy    |               |               | -28.9478      | 20    |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 22:
train loss improved to 0.00632
train loss: 0.00632 | val loss: 0.04795 | test loss: 0.02445

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 141.0490      | 432.9248      | 231.6501      | 22    |
| Val RMSE                     | 244.8369      | 410.5183      | 286.6487      | 9     |
| Test RMSE                    | 161.5188      | 447.1282      | 247.3596      | 20    |
| Best Train Custom Accuracy   | -1.3432       |               |               | 22    |
| Best Val Custom Accuracy     |               | -103.4056     |               | 9     |
| Best Test Custom Accuracy    |               |               | -28.9478      | 20    |
+------------------------------+---------------+---------------+---------------+-------+
Epoch 23:
test loss improved to 0.02427
train loss: 0.00632 | val loss: 0.04795 | test loss: 0.02427

Experiment Settings: seq_len-8-lr-0.1-d-32-hid_d-64-last_d-32-time_d-32-e_layers-2-comb_type-add-bs-1100
+------------------------------+---------------+---------------+---------------+-------+
| Metric                       | Training      | Validation    | Test          | Epoch |
+------------------------------+---------------+---------------+---------------+-------+
| Train RMSE                   | 141.0490      | 432.9248      | 231.6501      | 22    |
| Val RMSE                     | 244.8369      | 410.5183      | 286.6487      | 9     |
| Test RMSE                    | 158.1854      | 455.4085      | 248.7005      | 23    |
| Best Train Custom Accuracy   | -1.3432       |               |               | 22    |
| Best Val Custom Accuracy     |               | -103.4056     |               | 9     |
| Best Test Custom Accuracy    |               |               | -36.6071      | 23    |
+------------------------------+---------------+---------------+---------------+-------+
Error during experiment: WindPowerExperiment.__init__() missing 1 required positional argument: 'config'
Traceback (most recent call last):
  File "/data3/lsf/Pein/Power-Prediction/run_scripts/run_exp.py", line 50, in execute_experiment_with_logging
    execute_experiment(config)
  File "/data3/lsf/Pein/Power-Prediction/run_scripts/single_exp.py", line 106, in execute_experiment
    custom_test(
  File "/data3/lsf/Pein/Power-Prediction/utils/results.py", line 103, in custom_test
    pl_module = model_class.load_from_checkpoint(best_model_path)
  File "/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/pytorch_lightning/utilities/model_helpers.py", line 125, in wrapper
    return self.method(cls, *args, **kwargs)
  File "/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1586, in load_from_checkpoint
    loaded = _load_from_checkpoint(
  File "/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/pytorch_lightning/core/saving.py", line 91, in _load_from_checkpoint
    model = _load_state(cls, checkpoint, strict=strict, **kwargs)
  File "/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/pytorch_lightning/core/saving.py", line 165, in _load_state
    obj = instantiator(cls, _cls_kwargs) if instantiator else cls(**_cls_kwargs)
TypeError: WindPowerExperiment.__init__() missing 1 required positional argument: 'config'
Experiment finished.
