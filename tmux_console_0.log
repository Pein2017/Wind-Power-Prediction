[I 2024-08-02 15:47:22,863] A new study created in RDB with name: 24-08-02-farm_97
Creating study "24-08-02-farm_97" with storage "sqlite:////data3/lsf/Pein/Power-Prediction/optuna_results/24-08-02/24-08-02-farm_97.db"...
  0%|          | 0/420 [00:00<?, ?it/s]/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/optuna/distributions.py:700: UserWarning: The distribution is specified by [128, 512] and step=20, but the range is not divisible by `step`. It will be replaced by [128, 508].
  warnings.warn(
/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/optuna/distributions.py:700: UserWarning: The distribution is specified by [512, 1042] and step=20, but the range is not divisible by `step`. It will be replaced by [512, 1032].
  warnings.warn(
/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/optuna/distributions.py:700: UserWarning: The distribution is specified by [512, 1024] and step=20, but the range is not divisible by `step`. It will be replaced by [512, 1012].
  warnings.warn(
Seed set to 17
/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python /data3/lsf/Pein/Power-Prediction/run_scripts/run_opt ...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA RTX 6000 Ada Generation') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name      | Type    | Params | Mode 
----------------------------------------------
0 | model     | Model   | 12.0 M | train
1 | criterion | MSELoss | 0      | train
----------------------------------------------
12.0 M    Trainable params
0         Non-trainable params
12.0 M    Total params
48.085    Total estimated model params size (MB)
Metric Loss/val improved. New best score: 67.780
Metric Loss/val improved by 61.919 >= min_delta = 0.0. New best score: 5.861
Metric Loss/val improved by 1.775 >= min_delta = 0.0. New best score: 4.087
Metric Loss/val improved by 2.381 >= min_delta = 0.0. New best score: 1.705
Metric Loss/val improved by 0.645 >= min_delta = 0.0. New best score: 1.061
Monitored metric Loss/val did not improve in the last 10 records. Best score: 1.061. Signaling Trainer to stop.
                                         0%|          | 0/420 [01:33<?, ?it/s]Best trial: 0. Best value: 1.06311:   0%|          | 0/420 [01:33<?, ?it/s]Best trial: 0. Best value: 1.06311:   0%|          | 1/420 [01:33<10:55:21, 93.85s/it]/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/optuna/distributions.py:700: UserWarning: The distribution is specified by [128, 512] and step=20, but the range is not divisible by `step`. It will be replaced by [128, 508].
  warnings.warn(
/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/optuna/distributions.py:700: UserWarning: The distribution is specified by [512, 1042] and step=20, but the range is not divisible by `step`. It will be replaced by [512, 1032].
  warnings.warn(
/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/optuna/distributions.py:700: UserWarning: The distribution is specified by [512, 1024] and step=20, but the range is not divisible by `step`. It will be replaced by [512, 1012].
  warnings.warn(
                                                                                      Best trial: 0. Best value: 1.06311:   0%|          | 1/420 [01:34<10:55:21, 93.85s/it]                                                                                      Best trial: 0. Best value: 1.06311:   0%|          | 1/420 [01:35<10:55:21, 93.85s/it]                                                                                      Best trial: 0. Best value: 1.06311:   0%|          | 1/420 [01:35<10:55:21, 93.85s/it]Seed set to 17
/home/lsf/anaconda3/envs/Pein_310/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python /data3/lsf/Pein/Power-Prediction/run_scripts/run_opt ...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name      | Type    | Params | Mode 
----------------------------------------------
0 | model     | Model   | 29.1 M | train
1 | criterion | MSELoss | 0      | train
----------------------------------------------
29.1 M    Trainable params
0         Non-trainable params
29.1 M    Total params
116.505   Total estimated model params size (MB)
Metric Loss/val improved. New best score: 4.209
Metric Loss/val improved by 2.008 >= min_delta = 0.0. New best score: 2.200
Metric Loss/val improved by 0.276 >= min_delta = 0.0. New best score: 1.924
Metric Loss/val improved by 0.952 >= min_delta = 0.0. New best score: 0.972
